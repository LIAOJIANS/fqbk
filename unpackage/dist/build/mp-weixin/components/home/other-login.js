(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["components/home/other-login"],{2656:function(n,e,t){"use strict";(function(n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var r=o(t("4795"));function o(n){return n&&n.__esModule?n:{default:n}}function i(n,e,t,r,o,i,a){try{var u=n[i](a),c=u.value}catch(s){return void t(s)}u.done?e(c):Promise.resolve(c).then(r,o)}function a(n){return function(){var e=this,t=arguments;return new Promise((function(r,o){var a=n.apply(e,t);function u(n){i(a,r,o,u,c,"next",n)}function c(n){i(a,r,o,u,c,"throw",n)}u(void 0)}))}}function u(n,e){return d(n)||f(n,e)||s(n,e)||c()}function c(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function s(n,e){if(n){if("string"===typeof n)return l(n,e);var t=Object.prototype.toString.call(n).slice(8,-1);return"Object"===t&&n.constructor&&(t=n.constructor.name),"Map"===t||"Set"===t?Array.from(t):"Arguments"===t||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(t)?l(n,e):void 0}}function l(n,e){(null==e||e>n.length)&&(e=n.length);for(var t=0,r=new Array(e);t<e;t++)r[t]=n[t];return r}function f(n,e){if("undefined"!==typeof Symbol&&Symbol.iterator in Object(n)){var t=[],r=!0,o=!1,i=void 0;try{for(var a,u=n[Symbol.iterator]();!(r=(a=u.next()).done);r=!0)if(t.push(a.value),e&&t.length===e)break}catch(c){o=!0,i=c}finally{try{r||null==u["return"]||u["return"]()}finally{if(o)throw i}}return t}}function d(n){if(Array.isArray(n))return n}var v={props:{noback:{type:Boolean,default:!0}},data:function(){return{providerList:[]}},created:function(){},methods:{mpGetUserInfo:function(e){var t=this;if(n.showLoading({title:"登录中...",mask:!0}),"getUserInfo:ok"!==e.detail.errMsg)return n.hideLoading(),void n.showModal({title:"获取用户信息失败",content:"错误原因"+e.detail.errMsg,showCancel:!1});var r=e.detail.userInfo;n.login({provider:"weixin",success:function(n){t.MpLogin({url:"/wxlogin",code:n.code,nickName:r.nickName,avatarUrl:r.avatarUrl})},complete:function(){n.hideLoading()}})},MpLogin:function(e){var t=this;this.$http.post(e.url,{code:e.code,nickName:e.nickName,avatarUrl:e.avatarUrl}).then((function(e){var r=u(e,2),o=r[0],i=r[1];if(!t.$http.errorCheck(o,i))return!1;console.log(i.data.data),t.user.token=i.data.data.token,t.user.userinfo=t.user.__formatUserinfo(i.data.data),n.setStorageSync("userinfo",t.user.userinfo),n.setStorageSync("token",t.user.token),t.user.userinfo.id&&t.user.getCounts(),t.user.userinfo.id&&t.$chat.Open(),n.showToast({title:"登录成功"}),t.$emit("logining"),t.noback||n.navigateBack()}))},getLoginAuth:function(){var e=this;n.getProvider({service:"oauth",success:function(n){e.providerList=n.provider.map((function(n){var e="",t="";switch(n){case"weixin":e="微信登录",t="weixin";break;case"qq":e="QQ登录",t="QQ";break;case"sinaweibo":e="新浪微博登录",t="xinlangweibo";break}return{name:e,icon:t,id:n}}))},fail:function(n){console.log("获取登录通道失败",n)}})},tologin:function(e){var t=this;n.login({provider:e.id,success:function(r){n.showLoading({title:"登陆中...",mask:!1}),console.log(r),n.getUserInfo({provider:e.id,success:function(n){console.log(n),console.log(JSON.stringify(n.userInfo));var o=t.user.__formatOtherLogin(e.id,Object.assign(n,r));t.loginEvent(o)}}),console.log("登录成功，保存到本地存储，修改当前用户登录状态")},fail:function(n){console.log("login fail:",n)},complete:function(){n.hideLoading()}})},loginEvent:function(n){var e=this;return a(r.default.mark((function t(){var o;return r.default.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,e.user.login({url:"/user/otherlogin",data:n,Noback:e.noback});case 2:o=t.sent,o&&e.$emit("logining");case 4:case"end":return t.stop()}}),t)})))()}}};e.default=v}).call(this,t("543d")["default"])},"2ede":function(n,e,t){"use strict";var r,o=function(){var n=this,e=n.$createElement;n._self._c},i=[];t.d(e,"b",(function(){return o})),t.d(e,"c",(function(){return i})),t.d(e,"a",(function(){return r}))},"4c89":function(n,e,t){"use strict";t.r(e);var r=t("2656"),o=t.n(r);for(var i in r)"default"!==i&&function(n){t.d(e,n,(function(){return r[n]}))}(i);e["default"]=o.a},"4d8f":function(n,e,t){"use strict";t.r(e);var r=t("2ede"),o=t("4c89");for(var i in o)"default"!==i&&function(n){t.d(e,n,(function(){return o[n]}))}(i);t("89a0");var a,u=t("f0c5"),c=Object(u["a"])(o["default"],r["b"],r["c"],!1,null,null,null,!1,r["a"],a);e["default"]=c.exports},"89a0":function(n,e,t){"use strict";var r=t("eb29"),o=t.n(r);o.a},eb29:function(n,e,t){}}]);
;(global["webpackJsonp"] = global["webpackJsonp"] || []).push([
    'components/home/other-login-create-component',
    {
        'components/home/other-login-create-component':(function(module, exports, __webpack_require__){
            __webpack_require__('543d')['createComponent'](__webpack_require__("4d8f"))
        })
    },
    [['components/home/other-login-create-component']]
]);
